;;;; Email validation test suite
;;;; SPDX-License-Identifier: BSD-3-Clause
;;;; SPDX-FileCopyrightText: 2010-2013 Dominic Sayers
;;;; SPDX-FileCopyrightText: 2026 Arthur A. Gleckler
;;;;
;;;; Converted from isemail "tests.xml" (https://github.com/dominicsayers/isemail).
;;;;
;;;; Modified to collapse all errors into #false, and to reject addresses
;;;; containing control characters.
;;;;
;;;; Format: (test-id address expected-result)
;;;; expected-result: #true (accept) or #false (reject)

(define email-test-suite
  '((1   "" #false)
    (2   "test" #false)
    (3   "@" #false)
    (4   "test@" #false)
    (5   "test@io" #true)
    (6   "@io" #false)
    (7   "@iana.org" #false)
    (8   "test@iana.org" #true)
    (9   "test@nominet.org.uk" #true)
    (10  "test@about.museum" #true)
    (11  "a@iana.org" #true)
    (12  "test@e.com" #true)
    (13  "test@iana.a" #true)
    (14  "test.test@iana.org" #true)
    (15  ".test@iana.org" #false)
    (16  "test.@iana.org" #false)
    (17  "test..iana.org" #false)
    (18  "test_exa-mple.com" #false)
    (19  "!#$%&`*+/=?^`{|}~@iana.org" #true)
    (20  "test\\@test@iana.org" #false)
    (21  "123@iana.org" #true)
    (22  "test@123.com" #true)
    (23  "test@iana.123" #true)
    (24  "test@255.255.255.255" #true)
    (25  "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghiklm@iana.org" #true)
    (26  "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghiklmn@iana.org" #true)
    (27  "test@abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.com" #true)
    (28  "test@abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghiklm.com" #true)
    (29  "test@mason-dixon.com" #true)
    (30  "test@-iana.org" #false)
    (31  "test@iana-.com" #false)
    (32  "test@c--n.com" #true)
    (33  "test@iana.co-uk" #true)
    (34  "test@.iana.org" #false)
    (35  "test@iana.org." #false)
    (36  "test@iana..com" #false)
    (37  "a@a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.x.y.z.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.x.y.z.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.x.y.z.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.x.y.z.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v" #true)
    (38  "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghiklm@abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi" #true)
    (39  "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghiklm@abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghij" #true)
    (40  "a@abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefg.hij" #true)
    (41  "a@abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefg.hijk" #true)
    (42  "\"test\"@iana.org" #true)
    (43  "\"\"@iana.org" #true)
    (44  "\"\"\"@iana.org" #false)
    (45  "\"\\a\"@iana.org" #true)
    (46  "\"\\\"\"@iana.org" #true)
    (47  "\"\\\"@iana.org" #false)
    (48  "\"\\\\\"@iana.org" #true)
    (49  "test\"@iana.org" #false)
    (50  "\"test@iana.org" #false)
    (51  "\"test\"test@iana.org" #false)
    (52  "test\"text\"@iana.org" #false)
    (53  "\"test\"\"test\"@iana.org" #false)
    (54  "\"test\".\"test\"@iana.org" #true)
    (55  "\"test\\ test\"@iana.org" #true)
    (56  "\"test\".test@iana.org" #true)
    (57  "\"test\x00;\"@iana.org" #false)
    (58  "\"test\\\x00;\"@iana.org" #false)
    (59  "\"abcdefghijklmnopqrstuvwxyz abcdefghijklmnopqrstuvwxyz abcdefghj\"@iana.org" #true)
    (60  "\"abcdefghijklmnopqrstuvwxyz abcdefghijklmnopqrstuvwxyz abcdefg\\h\"@iana.org" #true)
    (61  "test@[255.255.255.255]" #true)
    (62  "test@a[255.255.255.255]" #false)
    (63  "test@[255.255.255]" #true)
    (64  "test@[255.255.255.255.255]" #true)
    (65  "test@[255.255.255.256]" #true)
    (66  "test@[1111:2222:3333:4444:5555:6666:7777:8888]" #true)
    (67  "test@[IPv6:1111:2222:3333:4444:5555:6666:7777]" #true)
    (68  "test@[IPv6:1111:2222:3333:4444:5555:6666:7777:8888]" #true)
    (69  "test@[IPv6:1111:2222:3333:4444:5555:6666:7777:8888:9999]" #true)
    (70  "test@[IPv6:1111:2222:3333:4444:5555:6666:7777:888G]" #true)
    (71  "test@[IPv6:1111:2222:3333:4444:5555:6666::8888]" #true)
    (72  "test@[IPv6:1111:2222:3333:4444:5555::8888]" #true)
    (73  "test@[IPv6:1111:2222:3333:4444:5555:6666::7777:8888]" #true)
    (74  "test@[IPv6::3333:4444:5555:6666:7777:8888]" #true)
    (75  "test@[IPv6:::3333:4444:5555:6666:7777:8888]" #true)
    (76  "test@[IPv6:1111::4444:5555::8888]" #true)
    (77  "test@[IPv6:::]" #true)
    (78  "test@[IPv6:1111:2222:3333:4444:5555:255.255.255.255]" #true)
    (79  "test@[IPv6:1111:2222:3333:4444:5555:6666:255.255.255.255]" #true)
    (80  "test@[IPv6:1111:2222:3333:4444:5555:6666:7777:255.255.255.255]" #true)
    (81  "test@[IPv6:1111:2222:3333:4444::255.255.255.255]" #true)
    (82  "test@[IPv6:1111:2222:3333:4444:5555:6666::255.255.255.255]" #true)
    (83  "test@[IPv6:1111:2222:3333:4444:::255.255.255.255]" #true)
    (84  "test@[IPv6::255.255.255.255]" #true)
    (85  "test @iana.org" #true)
    (86  "test@ iana .com" #true)
    (87  "test . test@iana.org" #true)
    (88  "\r\n test@iana.org" #false)
    (89  "\r\n \r\n test@iana.org" #false)
    (90  "(comment)test@iana.org" #true)
    (91  "((comment)test@iana.org" #false)
    (92  "(comment(comment))test@iana.org" #true)
    (93  "test@(comment)iana.org" #true)
    (94  "test(comment)test@iana.org" #false)
    (95  "test@(comment)[255.255.255.255]" #true)
    (96  "(comment)abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghiklm@iana.org" #true)
    (97  "test@(comment)abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghikl.com" #true)
    (98  "(comment)test@abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghik.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghik.abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijk.abcdefghijklmnopqrstuvwxyzabcdefghijk.abcdefghijklmnopqrstu" #true)
    (99  "test@iana.org\n" #false)
    (100 "test@xn--hxajbheg2az3al.xn--jxalpdlp" #true)
    (101 "xn--test@iana.org" #true)
    (102 "test@iana.org-" #false)
    (103 "\"test@iana.org" #false)
    (104 "(test@iana.org" #false)
    (105 "test@(iana.org" #false)
    (106 "test@[1.2.3.4" #false)
    (107 "\"test\\\"@iana.org" #false)
    (108 "(comment\\)test@iana.org" #false)
    (109 "test@iana.org(comment\\)" #false)
    (110 "test@iana.org(comment\\" #false)
    (112 "test@[RFC-5322-domain-literal]" #true)
    (113 "test@[RFC-5322]-domain-literal]" #false)
    (114 "test@[RFC-5322-[domain-literal]" #false)
    (115 "test@[RFC-5322-\\\x07;-domain-literal]" #false)
    (116 "test@[RFC-5322-\\\t-domain-literal]" #false)
    (117 "test@[RFC-5322-\\]-domain-literal]" #true)
    (118 "test@[RFC-5322-domain-literal\\]" #false)
    (119 "test@[RFC-5322-domain-literal\\" #false)
    (120 "test@[RFC 5322 domain literal]" #true)
    (121 "test@[RFC-5322-domain-literal] (comment)" #true)
    (122 "\x7f;@iana.org" #false)
    (123 "test@\x7f;.org" #false)
    (124 "\"\x7f;\"@iana.org" #false)
    (125 "\"\\\x7f;\"@iana.org" #false)
    (126 "(\x7f;)test@iana.org" #false)
    (127 "test@iana.org\r" #false)
    (128 "\rtest@iana.org" #false)
    (129 "\"\rtest\"@iana.org" #false)
    (130 "(\r)test@iana.org" #false)
    (131 "test@iana.org(\r)" #false)
    (132 "\ntest@iana.org" #false)
    (133 "\"\n\"@iana.org" #false)
    (134 "\"\\\n\"@iana.org" #false)
    (135 "(\n)test@iana.org" #false)
    (136 "\x07;@iana.org" #false)
    (137 "test@\x07;.org" #false)
    (138 "\"\x07;\"@iana.org" #false)
    (139 "\"\\\x07;\"@iana.org" #false)
    (140 "(\x07;)test@iana.org" #false)
    (141 "\r\ntest@iana.org" #false)
    (142 "\r\n \r\ntest@iana.org" #false)
    (143 "\r\ntest@iana.org" #false)
    (144 "\r\n test@iana.org" #false)
    (145 "\r\n \r\ntest@iana.org" #false)
    (146 "\r\n\r\ntest@iana.org" #false)
    (147 "\r\n\r\n test@iana.org" #false)
    (148 "test@iana.org\r\n" #false)
    (149 "test@iana.org\r\n \r\n" #false)
    (150 "test@iana.org\r\n" #false)
    (151 "test@iana.org\r\n \r\n" #false)
    (152 "test@iana.org \r\n" #false)
    (153 "test@iana.org \r\n" #false)
    (154 "test@iana.org \r\n \r\n" #false)
    (155 "test@iana.org \r\n\r\n" #false)
    (156 "test@iana.org \r\n\r\n" #false)
    (157 "test@iana.org" #true)
    (158 "test@iana.org" #true)
    (159 "test@[IPv6:1::2:]" #true)
    (160 "\"test\\Â©\"@iana.org" #false)
    (161 "test@iana/icann.org" #true)
    (165 "test.(comment)test@iana.org" #true)
    (166 "test@org" #true)
    (167 "test@test.com" #true)
    (168 "test@nic.no" #true)))